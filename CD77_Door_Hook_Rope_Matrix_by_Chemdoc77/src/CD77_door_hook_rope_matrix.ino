/*
 
CD77_door_hook_rope Matrix by Chemdoc77

Based by code from different sources.
See each tab for the sources.

 License

The code and specifically the animations that come with it are licenced under a Creative Commons Attribution License CC BY-NC-SA 4.0

For non-commercial purposes you're welcome to use the code and animations in any way you like.

In case you would like to use my code or animations in your commercial project or product please contact me and we'll find a fair licensing solution we're both happy with.


*/

#include <Arduino.h>
#include <FastLED.h>

#define LED_PIN 12
#define CHIPSET NEOPIXEL
#define NUM_LEDS 256

#define BRIGHTNESS 50
CRGB leds[NUM_LEDS];

//Time Performance code

uint32_t gTimeCodeBase = 0;
uint32_t gTimeCode = 0;
uint32_t gLastTimeCodeDoneAt = 0;
uint32_t gLastTimeCodeDoneFrom = 0;
//=================


byte coordsX[NUM_LEDS] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 85, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 170, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255 };
byte coordsY[NUM_LEDS] = { 213, 209, 206, 202, 198, 194, 190, 186, 183, 179, 175, 171, 167, 164, 160, 156, 152, 148, 145, 141, 137, 133, 129, 126, 122, 118, 114, 110, 107, 103, 99, 95, 91, 88, 84, 80, 76, 72, 69, 65, 61, 57, 53, 49, 46, 42, 38, 34, 30, 27, 23, 19, 15, 11, 8, 4, 0, 0, 4, 8, 11, 15, 19, 23, 27, 30, 34, 38, 42, 46, 49, 53, 57, 61, 65, 69, 72, 76, 80, 84, 88, 91, 95, 99, 103, 107, 110, 114, 118, 122, 126, 129, 133, 137, 141, 145, 148, 152, 156, 160, 164, 167, 171, 175, 179, 183, 186, 190, 194, 198, 202, 206, 209, 213, 217, 221, 225, 228, 232, 236, 240, 244, 247, 244, 240, 236, 232, 228, 225, 221, 217, 213, 209, 206, 202, 198, 194, 190, 186, 183, 179, 175, 171, 167, 164, 160, 156, 152, 148, 145, 141, 137, 133, 129, 126, 122, 118, 114, 110, 107, 103, 99, 95, 91, 88, 84, 80, 76, 72, 69, 65, 61, 57, 53, 49, 46, 42, 38, 34, 30, 27, 23, 19, 15, 11, 8, 4, 0, 0, 4, 8, 11, 15, 19, 23, 27, 30, 34, 38, 42, 46, 49, 53, 57, 61, 65, 69, 72, 76, 80, 84, 88, 91, 95, 99, 103, 107, 110, 114, 118, 122, 126, 129, 133, 137, 141, 145, 148, 152, 156, 160, 164, 167, 171, 175, 179, 183, 186, 190, 194, 198, 202, 206, 209, 213, 217, 221, 225, 228, 232, 236, 240, 244, 247, 251, 255 };
byte angles[NUM_LEDS] = { 195, 195, 195, 196, 196, 196, 196, 197, 197, 197, 198, 199, 199, 200, 201, 203, 204, 207, 210, 215, 223, 236, 0, 19, 32, 40, 45, 48, 51, 52, 54, 55, 56, 56, 57, 58, 58, 58, 59, 59, 59, 59, 60, 60, 60, 60, 60, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 63, 63, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 62, 61, 61, 61, 61, 61, 61, 60, 60, 60, 59, 59, 58, 57, 56, 54, 51, 45, 32, 0, 223, 210, 204, 201, 199, 198, 197, 196, 196, 195, 195, 195, 194, 194, 194, 194, 194, 194, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 193, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 0, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 65, 66, 66, 66, 66, 66, 66, 66, 66, 66, 67, 67, 67, 67, 68, 68, 69, 70, 70, 72, 74, 77, 83, 96, 128, 159, 172, 178, 181, 183, 185, 185, 186, 187, 187, 188, 188, 188, 188, 189, 189, 189, 189, 189, 189, 189, 189, 189, 190, 190, 190, 190, 190, 190, 190, 190, 190, 190 };
byte radii[NUM_LEDS] = { 165, 158, 150, 143, 136, 128, 121, 113, 106, 98, 91, 84, 76, 69, 62, 55, 47, 40, 33, 27, 21, 17, 15, 17, 21, 27, 33, 40, 47, 55, 62, 69, 76, 84, 91, 98, 106, 113, 121, 128, 136, 143, 150, 158, 165, 173, 180, 188, 195, 203, 210, 218, 225, 233, 240, 248, 255, 255, 247, 240, 232, 225, 217, 210, 202, 195, 187, 180, 172, 165, 157, 150, 142, 135, 128, 120, 113, 105, 98, 90, 83, 75, 68, 60, 53, 46, 38, 31, 24, 17, 11, 7, 11, 17, 24, 31, 38, 46, 53, 60, 68, 75, 83, 90, 98, 105, 113, 120, 128, 135, 142, 150, 157, 165, 172, 180, 187, 195, 202, 210, 217, 225, 232, 225, 217, 210, 202, 195, 187, 180, 172, 165, 157, 150, 142, 135, 127, 120, 112, 105, 97, 90, 82, 75, 67, 60, 52, 45, 37, 30, 22, 15, 7, 0, 7, 15, 22, 30, 37, 45, 52, 60, 67, 75, 82, 90, 97, 105, 112, 120, 127, 135, 142, 150, 157, 165, 172, 180, 187, 195, 202, 210, 217, 225, 232, 240, 247, 255, 255, 247, 240, 232, 225, 217, 210, 202, 195, 187, 180, 172, 165, 157, 150, 142, 135, 128, 120, 113, 105, 98, 90, 83, 75, 68, 60, 53, 46, 38, 31, 24, 17, 11, 7, 11, 17, 24, 31, 38, 46, 53, 60, 68, 75, 83, 90, 98, 105, 113, 120, 128, 135, 142, 150, 157, 165, 172, 180, 187, 195, 202, 210, 217, 225, 232, 240, 247 };




uint8_t offset = 0;
uint8_t speed = 30;

//========================
CRGBPalette16 currentPalette = PartyColors_p;

#include "Marquee.h"
#include "ropestuff.h"
#include "Time_performance.h"

void setup() {

delay(1000); // sanity delay
FastLED.addLeds<CHIPSET, LED_PIN>(leds, NUM_LEDS);
FastLED.setBrightness( BRIGHTNESS );


FastLED.setMaxPowerInVoltsAndMilliamps(5,8500);
 set_max_power_indicator_LED(13);
 fill_solid(leds, NUM_LEDS, CRGB::Black);
  FastLED.show();
  
//Time Performance code
   RestartPerformance();
 
}

//============================================
void loop() {  
//ropestuff stuff:
 offset = beat8(speed);
 //Time Performance code
  gTimeCode = millis() - gTimeCodeBase;  
  Performance();
}
